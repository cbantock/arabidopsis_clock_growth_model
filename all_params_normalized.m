% define parameters 

m1=0.54; m2=0.24; m3=0.2; m4=0.2; m5=0.3; m6=0.1; m7=0.1; m8=0.5; m9=0.2; m10=0.1; m11=1; m12=1; m13=0.32; m14=0.4; m15=0.7; 
m16=0.5; m17=0.5; m18=3.4; m19=0.9; m20=0.6; m21=0.08; m22=0.1; m23=0.1; m24=0.1; m25=0.9; m26=0.5; m27=0.1; m28=28; 
m29=0.3; m30=1; m31=0.1; m32=0.2; m33=13; m34=0.6; m35=0.3; m36=0.3; m37=0.4; m38=0.3; m39=0.2;

n1=2.6; n2=0.35; n3=0.29; n4=0.04; n5=0.4; n6=20; n7=0.1; n8=0.5; n9=0.6; n10=0.3; n11=0.6; n12=9; n13=2; 
n14=0.1; n15=2; n16=0.1; n17=0.5; n18=0.5; n19=0.2;

p1=0.13; p2=0.27; p3=0.1; p4=0.5; p5=1; p6=0.2; p7=0.3; p8=0.6; p9=0.8; p10=0.54; p11=0.5; p12=10; p13=0.1; p14=0.14; p15=2; p16=0.62; 
p17=17; p18=4; p19=1; p20=0.1; p21=1; p22=0.5; p23=0.37; p24=11; p25=2; p26=0.3; p27=0.8; p28=2; p29=0.1; p30=0.9; p31=0.1; p32=0.1;  p33=0.2;

g1=0.1; g2=0.01; g3=0.6; g4=0.005; g5=0.2; g6=0.3; g7=1; g8=0.04; g9=0.3; g10=0.5; g11=0.7; g12=0.1; g13=1; g14=0.02; g15=0.4; g16=0.3; 
g17=0.6; g18=0.4; g19=0.4; g20=0.03; g21=0.4; g22=0.1; g23=0.4; g24=0.3; g25=0.4; g26=0.3; g27=0.2; g28=0.1; g29=1;

a=2; b=2; c=2; d=2; e=2; f=2; g=2; h=2; i=2; j=2;
q1=1; q2=1.56; q3=3; 

A0=1; n16=0; m24=0.5; m23=0.5; g23=0.6; g25=0.5; g4=0.006; m6=0.2;

period=24;
%dusk=8;
day_numb=5;

Loffset=0;
Lamplitude=1;

L=[];

t1=[0 2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36];
cLm6=[3.79 1.36 0.4 0.055 0.009275 0.004335 0.022135 0.025 0.155 1.4 4.81 5.49 4.735 1.17 0.395 0.065 0.005155 0.002805 0.0016465]/4.67;
cLm12=[4.67 1.9 0.69 0.1 0.01 0.0032 0.0025 0.001285 0.00579 0.065 0.715 2.785 4.285 1.48 0.665 0.135 0.009405 0.00225 0.00154]/4.67;
cLm18=[3.07 2.02 0.835 0.23 0.045 0.006315 0.00675 0.009195 0.03 0.115 0.09 0.595 2.5 2.44 0.93 0.285 0.045 0.00931 0.00487]/4.67;


t2=[0 4.0190 8.2687 12 16.26350935 20.299 23.773];
Cl_m=[1 0.1221 0.004 0.001 0.004 0.1386 1.0098]; % wt LD LHY Farre05


Cl_m_Kieron=[1 0.406852248 0.147751606 0.021413276 0.002141328 0.000685225 0.000535332 0.000275161 0.001239829 0.01391863 0.153104925 0.596359743 0.86509636]; % wt LD LHY Kieron
t3=[0 2 4 6 8 10 12 14 16 18 20 22 24];


Cl_p_cca1=[0.31 0.72 1 0.74 0.54 0.336 0.18];
t55=[0 0.24 1.12 2.04 4.24 6 22];


Cg_m=[0.49 0.49132948 1 0.034682081 0 0]; % wt LD GI
t8=[1.1 5 9.2 13.20340865 17.30115603 21];

Cp5_m=[0.020408163 0.624489796 1 0.628624435 0.057142857 0]; %wt LD PRR5
t9=[5.0641 7.0556 9.0471 11.0386 13.0301 15.0785];


Cp5_m_M=[0.060606061 0.078787879 1 0.878787879 0.272727273 0.115787716 0.145958722 0.090909091 0.067759636]; % wt LD PRR5
t12=[0 3.36 6.24 9.12 12.24 15.12 18.12158933 21.12136359 24.00479952];


Ct_m_K=[0.361904762 0.371428571 0.685714286 1 0.514285714 0.49047619]; % wt LD TOC1
t14=[0.962 4.884 8.954 12.95 16.946 20.942];

Cz=[0.157894737 0.184210526 0.450453757 1 0.738719413 0.526315789]; % wt LD ZTL
t15=[1.068 4.99669811 9.256 13.172 17.088 21.182];

C9_mm=[0.06 1.000449899 0.16 0.09 0.05]; %wt LD PRR9
t16m=[-1.644 1.294 7.17 10.334 22.54199969];

C9_m=[1 0.55 0.15]; % Matsushika 00
t16=[1 3.3 14.4];

Cg_m_L=[0.037974684 0.177666694 0.348101266 0.297468354 0.265822785 1 0.670886076 0.456091601 0.076996994 0.040028831 0.056962025 0.044303797 0.044303797];
t17=[0 0.735391052 1.3 2.08 4.42 7.28 10.14 12 13.82 15.38 17.98 21.1 23.96];


C7_m=[0.18 0.32 0.52 0.71 1 0.72 0.39 0.21 0.14 0.18];
t19n=[0 2.18 3.27 4.91 6.54 7.63 11.45 13.63 16.08 24];


Ct_m_N=[0.186440678 0.169491525 0.279661017 1.000574383 0.974576271 0.644569385 0.56779661 0.610404851]; % wt LD TOC1
t22=[0 2.99 6.095 9.085 12.305 15.41 18.515 21.85];


t33=[1.22 3.22 5.22 7.22 9.22 11.22 13.23 15.23 17.23 19.23 21.23 23.23 25.23 27.23 29.24 31.24 33.24 35.24 37.24 39.24 41.24 43.25 45.25 47.25 49.25 51.25 53.25 55.25 57.26 59.26 61.26 63.26 65.26 67.26 69.26 71.27 73.27 75.27 77.27 79.27 81.27 83.27 85.28 87.28 89.28 91.28 93.28 95.28 97.28 99.28 101.29 103.29 105.29 107.29 109.29 111.29 113.29 115.30 117.30 119.30 121.30  123.30 125.30 127.30 129.31 131.31 133.31 135.31 137.31 139.31 141.31 143.32 145.32 147.32 149.32]; 
CTlc=[1.45E+07 2.02E+07 2.70E+07 3.07E+07 3.15E+07 3.09E+07 2.90E+07 2.58E+07 2.24E+07 1.93E+07  1.83E+07 2.03E+07 2.27E+07 2.49E+07 2.53E+07 2.39E+07 2.10E+07 1.81E+07 1.65E+07 1.69E+07 1.82E+07 1.95E+07 2.03E+07 1.99E+07 1.85E+07 1.67E+07 1.53E+07 1.52E+07 1.59E+07 1.67E+07 1.74E+07 1.76E+07 1.68E+07 1.55E+07 1.43E+07 1.39E+07 1.43E+07 1.49E+07 1.51E+07 1.50E+07 1.48E+07 1.39E+07 1.32E+07 1.28E+07 1.28E+07 1.30E+07 1.32E+07 1.32E+07 1.28E+07 1.27E+07 1.23E+07 1.21E+07 1.21E+07 1.21E+07 1.22E+07 1.21E+07 1.20E+07 1.18E+07 1.19E+07 1.18E+07 1.16E+07 1.17E+07 1.15E+07 1.13E+07 1.11E+07 1.11E+07 1.10E+07 1.09E+07 1.11E+07 1.12E+07 1.11E+07 1.11E+07 1.11E+07 1.09E+07 1.09E+07]; % TOC1:LUC in lhy/cca1 in LL; raw data 
CTlcg=[4.54E+06 5.71E+06 8.42E+06 1.08E+07 1.15E+07 1.13E+07 1.00E+07 8.64E+06 7.39E+06 6.38E+06 5.79E+06 5.64E+06 5.91E+06 6.16E+06 6.19E+06 5.98E+06 5.64E+06 5.29E+06 4.98E+06 4.74E+06 4.51E+06 4.36E+06 4.19E+06 4.08E+06 3.94E+06 3.80E+06 3.64E+06 3.50E+06 3.45E+06 3.40E+06 3.36E+06 3.38E+06 3.30E+06 3.20E+06 3.10E+06 3.02E+06 2.95E+06 2.92E+06 2.91E+06 2.89E+06 2.87E+06 2.84E+06 2.81E+06 2.78E+06 2.75E+06 2.68E+06 2.63E+06 2.58E+06 2.52E+06 2.54E+06 2.49E+06 2.46E+06 2.42E+06 2.38E+06 2.36E+06 2.31E+06 2.30E+06 2.26E+06 2.25E+06 2.24E+06 2.22E+06 2.22E+06 2.18E+06 2.16E+06 2.15E+06 2.13E+06 2.09E+06 2.10E+06 2.07E+06 2.08E+06 2.05E+06 2.05E+06 2.04E+06 2.05E+06 2.07E+06]; % TOC1:LUC in lhy/cca1/gi in LL; raw data 

t34=[0 4 4 8 8 12 12 16 16 20 20 24 24]; % LUX Hazen 2005
CLUX=[0.13 0.11 0.2 0.95 0.25 0.22 0.69 0.38 1 0.1 0.66 0.2 0.43];

t34=[]; % LUX Hazen 2005
CLUX=[];
t34=[0 4 8 12 16 20 24]; % LUX Hazen 2005
CLUX=[0.13 0.11 0.95 0.22 0.38 0.1 0.2];
CLUX2=[0.17 0.13 0.71 1 0.33 0.25 0.3]; % LUX Helfer 2011
C92=[0 1 0.25 0.04 0.02 0 0.03]; % PRR9 Helfer 2011

t35=[0 2 4 6 8 10 12 14 16 18 20 22];  % ELF3 Dixon 2011
CE3=[0.51 0.24 0.27 0.49 0.83 1.39 1.13 1.03 1.84 1.56 1.25 1.14];
CE3=CE3/3.;
CP7=[0.06 0.85 1.83 2.85 3.19 1.95 0.59 0.09 0.02 0.01 0.02 0.03];
CP7=CP7/3.19;
CP9=[0.16 3.73 3.88 2.73 0.7 0.11 0.04 0.01 0.01 0.02 0.04 0.09];
CP9=CP9/3.88;

n16_ar=[0 0.03 0.05 0.1 0.2 0.3];
per_n16=[24.2 24.9 25.5 25.9 27 34];

t = [0 day_numb*period];

%Solving the ODEs and draw traectories
options=odeset('stat','off');

    y0=[0.9548 0.956 0.0768 0.0206 0.5005 0.0656 0.0251 0.1502 0.0699 0.0137 0.0873 0.2505 0.1419 0.1554 0.0663 0.1811 0.0849 0.2527 0.4923 0.0811 0.856 1.3143 0.2893 0.1485 0.2234 0.8445 0.4068 0.0995 0.6628 0.4027 0.2362 0.2843 0.1342 0.4764 0.0319];
       
%[T, Y] = ode23s(@Model_ABA_art_fin,t,y0,options,q1,q2,q3,p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,m1,m2,m3,m4,m5,m6,m7,m8,m9,m10,m11,m12,m13,m14,m15,m16,m17,m18,m19,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29,m30,m31,m32,m33,m34,m35,m36,m37,m38,m39,n1,n2,n3,n4,n5,n6,n7,n8,n9,n10,n11,n12,n13,n14,n15,n16,n17,n18,n19,g1,g2,g3,g4,g5,g6,g7,g8,g9,g10,g11,g12,g13,g14,g15,g16,g17,g18,g19,g20,g21,g22,g23,g24,g25,g26,g27,g28,g29,a,b,c,d,e,f,g,h,i,j,dusk,period,Loffset,Lamplitude,A0);

%GI nuclear protein
%GN=p28*Y(:,10)./(p29+m19+p17*Y(:,25));

% nuclear protein complex ELF3-GI
%EGN=(p18*Y(:,4)+p17*Y(:,25).*GN)./(m10*Y(:,26)+m9*Y(:,27)+p22);

% nuclear protein complex ELF3-ELF4
%E34=p25*Y(:,19).*Y(:,25)./(p26*Y(:,29)+p21+m10*Y(:,26)+m9*Y(:,27));

%ABA complex with ABAR protein
%AR=A0*Y(:,21)./(Y(:,21)+g29);
%AR=0.5*(A0+Y(:,21)+g29-sqrt((A0+Y(:,21)+g29).^2-4*A0*Y(:,21)));

Temp=[22 28];
mutants=['Col' 'cop1-4' 'COP1-OE' 'pif4' 'elf3-8' 'elf3-8_cop1-4' 'ELF3ox' 'ELF3ox_cop1-4' 'hy5' 'phyB-9' 'PHYBox' 'pif4' 'PIF4ox' 'pifq'];
     
Daylength2=[0 0.1 0.2 0.3 0.4 0.5 1 2 3 4 4 6 8 10 12 14 16 18 20 22 24];


L=[];
t = [0 day_numb*period];

param_growth_values=[0.856277 0.232 0.411 107.721 127.371 39.8276 7.28611 27.1717 0.332432 0.0282255 4.90813 34.3248 0.312999 5.37007 112.374 1.7888 0.00905235 0.113031 2.9332 0.465035 10.6834 116.486 0.179771 64.996 1.18531 6.36723 0.495272 0.198035 498.851 0.032278 0.0562589];
params_clock = [q1,q2,q3,p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,m1,m2,m3,m4,m5,m6,m7,m8,m9,m10,m11,m12,m13,m14,m15,m16,m17,m18,m19,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29,m30,m31,m32,m33,m34,m35,m36,m37,m38,m39,n1,n2,n3,n4,n5,n6,n7,n8,n9,n10,n11,n12,n13,n14,n15,n16,n17,n18,n19,g1,g2,g3,g4,g5,g6,g7,g8,g9,g10,g11,g12,g13,g14,g15,g16,g17,g18,g19,g20,g21,g22,g23,g24,g25,g26,g27,g28,g29,a,b,c,d,e,f,g,h,i,j,period,Loffset,Lamplitude,A0];
%[pB28, kr22, kr28, pE122, pE128, pE222, pE228, dE, pPE22, pPE28, dP, kPC, dPB, pCL28, pCD, dC, pG, kG, pGP, pGE, pGB, pGH, pHC, mutBox,mutEox, mutPox, mutPko1, mutPko2, mutCox, mutCko1,mutCko2] = params_growth(:)

%Solving the ODEs and draw traectories
options=odeset('stat','off');

    yg0=[0.9548 0.956 0.0768 0.0206 0.5005 0.0656 0.0251 0.1502 0.0699 0.0137 0.0873 0.2505 0.1419 0.1554 0.0663 0.1811 0.0849 0.2527 0.4923 0.0811 0.856 1.3143 0.2893 0.1485 0.2234 0.8445 0.4068 0.0995 0.6628 0.4027 0.2362 0.2843 0.1342 0.4764 0.0319 0 0.2234 0 1.2513 0];
    mut = [];
       
%[TG, YG] = ode23s(@growth, t, yg0, options, Temp, Daylength2, mutants, pB28, kr22, kr28, pE122, pE128, pE222, pE228, dE, pPE22, pPE28, dP, kPC, dPB, pCL28, pCD, dC, pG, kG, pGP, pGE, pGB, pGH, pHC, mutBox,mutEox, mutPox, mutPko1, mutPko2, mutCox, mutCko1,mutCko2) ;
[T0, Y0] = ode23s(@clock_linked_growth_model_normalized, t, yg0, options, 0, 164.304813, 45.789104,188.550697,  params_clock,Temp,Daylength2, mut, param_growth_values);
[T4, Y4] = ode23s(@clock_linked_growth_model_normalized, t, yg0, options, 4, 64.479027, 42.654345,96.468652, params_clock,Temp,Daylength2, mut, param_growth_values);
[T8, Y8] = ode23s(@clock_linked_growth_model_normalized, t, yg0, options, 8, 48.997651, 33.553996, 82.347448, params_clock,Temp,Daylength2, mut, param_growth_values);
[T12, Y12] = ode23s(@clock_linked_growth_model_normalized, t, yg0, options, 12, 40.022205, 26.377630, 67.071580, params_clock,Temp,Daylength2, mut, param_growth_values);
[T16, Y16] = ode23s(@clock_linked_growth_model_normalized, t, yg0, options, 16, 35.360305, 19.055355, 52.987182,  params_clock,Temp,Daylength2, mut, param_growth_values);
[T20, Y20] = ode23s(@clock_linked_growth_model_normalized, t, yg0, options, 20, 46.652745, 11.034115, 65.133519, params_clock,Temp,Daylength2, mut, param_growth_values);
[T24, Y24] = ode23s(@clock_linked_growth_model_normalized, t, yg0, options, 24, 53.416599, 0.565528, 106.311813, params_clock,Temp,Daylength2, mut, param_growth_values);
     